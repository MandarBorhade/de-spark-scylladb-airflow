
docker exec -it spark-master /opt/spark/bin/spark-submit --master spark://spark-master:7077 --packages io.delta:delta-spark_2.12:3.0.0 --conf "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension" --conf "spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog" /opt/spark/work-dir/scripts/python/write_delta.py
docker exec -it spark-master /opt/spark/bin/spark-submit --master spark://spark-master:7077 --packages io.delta:delta-spark_2.12:3.0.0,com.datastax.spark:spark-cassandra-connector_2.12:3.5.0 --conf "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension" --conf "spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog" /opt/spark/work-dir/scripts/python/ingest_to_scylla.py

docker exec -it spark-master /opt/spark/bin/spark-submit --master spark://spark-master:7077 --packages io.delta:delta-spark_2.12:3.0.0 --conf "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension" --conf "spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog" /opt/spark/work-dir/scripts/python/transform_daily_totals.py
docker exec -it spark-master /opt/spark/bin/spark-submit --master spark://spark-master:7077 --packages io.delta:delta-spark_2.12:3.0.0,com.datastax.spark:spark-cassandra-connector_2.12:3.5.0 --conf "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension" --conf "spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog" --conf "spark.cassandra.connection.host=scylla" /opt/spark/work-dir/scripts/python/ingest_totals_to_scylla.py

docker exec -it scylla cqlsh


✅ Dirty Data Patterns Added
- Duplicate transaction IDs (every 50th record).
- Negative amounts (every 75th record).
- Null customer IDs (every 30th record).
- Corrupted merchant names (???INVALID### every 40th record).
- Bad timestamp formats (every 60th record).
- Extreme outlier amounts (every 90th record, ×1000 multiplier).



docker-compose up -d

# Initialize Airflow DB and create admin user
docker exec -it airflow-webserver airflow db init
docker exec -it airflow-webserver airflow users create --username admin --firstname admin --lastname admin --role Admin --email admin@example.com --password admin